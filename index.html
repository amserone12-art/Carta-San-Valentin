<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carta Ultra Final</title>

<style>
body{
margin:0;
overflow:hidden;
font-family:'Segoe UI',sans-serif;
background:radial-gradient(circle at center,#f6eadb,#edd4b5);
}

/* TITULO */
.title{
position:absolute;
top:5%;
width:100%;
text-align:center;
font-size:36px;
font-weight:bold;
color:#7a1c1c;
z-index:20;
}

/* CORAZON BOTON */
.heartBtn{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%) rotate(-45deg);
width:180px;
height:180px;
background:#ff1a4d;
cursor:pointer;
animation:beat 1.2s infinite;
z-index:20;
}

.heartBtn:before,.heartBtn:after{
content:"";
position:absolute;
width:180px;
height:180px;
background:#ff1a4d;
border-radius:50%;
}
.heartBtn:before{ top:-90px;}
.heartBtn:after{ left:90px;}

@keyframes beat{
0%,100%{ transform:translate(-50%,-50%) scale(1) rotate(-45deg);}
50%{ transform:translate(-50%,-50%) scale(1.15) rotate(-45deg);}
}

/* FOTO */
.photo{
position:absolute;
bottom:140px;
width:100%;
text-align:center;
z-index:10;
}
.photo img{
width:230px;
border-radius:15px;
box-shadow:0 15px 35px rgba(0,0,0,.3);
}

/* CONTADOR */
.counter{
position:absolute;
bottom:40px;
width:100%;
text-align:center;
font-size:24px;
font-weight:bold;
color:#7a1c1c;
z-index:10;
}

canvas{
position:absolute;
top:0;
left:0;
}

</style>
</head>

<body>

<div class="title" id="title">¿Hola Amoti quieres ser mi San Valentin?</div>
<div class="heartBtn" onclick="start()"></div>

<canvas id="canvas"></canvas>

<div class="photo">
<img src="TU-FOTO.jpg">
</div>

<div class="counter" id="counter"></div>

<!-- MUSICA -->
<iframe width="0" height="0"
src="https://www.youtube.com/embed/OhJ-S9Nrh7Q?autoplay=1&loop=1&playlist=OhJ-S9Nrh7Q"
allow="autoplay"></iframe>

<script>

const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

/* SISTEMAS */
let progress=0;
let lights=[];
let petals=[];
let floatingHearts=[];
let mouse={x:0,y:0};

/* LUCES */
for(let i=0;i<60;i++){
lights.push({
x:Math.random()*canvas.width,
y:Math.random()*canvas.height,
r:Math.random()*2+1
});
}

/* PETALOS */
for(let i=0;i<25;i++){
petals.push({
x:Math.random()*canvas.width,
y:Math.random()*canvas.height,
vy:Math.random()*0.6+0.3
});
}

/* CORAZONES PARALLAX */
for(let i=0;i<20;i++){
floatingHearts.push({
x:Math.random()*canvas.width,
y:Math.random()*canvas.height,
depth:Math.random()*1
});
}

/* CORAZON */
function heart(x,y,s){
ctx.save();
ctx.translate(x,y);
ctx.rotate(-Math.PI/4);
ctx.fillStyle="#ff1a4d";
ctx.fillRect(0,0,s,s);
ctx.beginPath();
ctx.arc(0,s/2,s/2,0,Math.PI*2);
ctx.arc(s/2,0,s/2,0,Math.PI*2);
ctx.fill();
ctx.restore();
}

/* ARBOL */
function tree(p){
let x=canvas.width/2;
let y=canvas.height*0.8;

ctx.strokeStyle="#5a3a21";
ctx.lineCap="round";

/* TRONCO */
ctx.lineWidth=9;
ctx.beginPath();
ctx.moveTo(x,y);
ctx.lineTo(x,y-260*p);
ctx.stroke();

/* RAMAS */
ctx.lineWidth=6;
ctx.beginPath();
ctx.moveTo(x,y-180*p);
ctx.lineTo(x-170*p,y-320*p);
ctx.stroke();

ctx.beginPath();
ctx.moveTo(x,y-180*p);
ctx.lineTo(x+170*p,y-320*p);
ctx.stroke();
}

/* TEXTO TYPE */
let typed=false;
function typeText(){
if(typed) return;
typed=true;
let t="¿Hola Amoti quieres ser mi San Valentin?";
let el=document.getElementById("title");
el.innerHTML="";
let i=0;
let interval=setInterval(()=>{
el.innerHTML+=t[i];
i++;
if(i>=t.length) clearInterval(interval);
},50);
}

/* LOOP */
function animate(){

ctx.clearRect(0,0,canvas.width,canvas.height);

/* LUCES */
lights.forEach(l=>{
ctx.fillStyle="rgba(255,255,255,0.4)";
ctx.beginPath();
ctx.arc(l.x,l.y,l.r,0,Math.PI*2);
ctx.fill();
});

/* PETALOS */
petals.forEach(p=>{
heart(p.x,p.y,10);
p.y+=p.vy;
if(p.y>canvas.height) p.y=0;
});

/* PARALLAX */
floatingHearts.forEach(h=>{
h.x+=(mouse.x-canvas.width/2)*0.0005*(h.depth);
h.y+=(mouse.y-canvas.height/2)*0.0005*(h.depth);
heart(h.x,h.y,12*(1-h.depth));
});

/* ARBOL */
if(progress<1) progress+=0.002;
tree(progress);

/* CORAZON SUPERIOR */
if(progress>0.85){
heart(canvas.width/2,canvas.height*0.25,140*(progress-0.85)*6);
}

requestAnimationFrame(animate);
}

/* MOUSE */
window.addEventListener("mousemove",e=>{
mouse.x=e.clientX;
mouse.y=e.clientY;
});

/* START */
function start(){
document.querySelector(".heartBtn").style.display="none";
typeText();
animate();
}

/* CONTADOR */
const startDate=new Date("2024-10-01T00:00:00");

setInterval(()=>{
const now=new Date();
const diff=now-startDate;

let d=Math.floor(diff/(1000*60*60*24));
let h=Math.floor((diff/(1000*60*60))%24);
let m=Math.floor((diff/(1000*60))%60);
let s=Math.floor((diff/1000)%60);

document.getElementById("counter").innerHTML=
"Mi amor por ti comenzó hace:<br>"+
d+" días "+h+" horas "+m+" min "+s+" seg";
},1000);

</script>

</body>
</html>
